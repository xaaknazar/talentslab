# Инструкция по деплою исправлений

## Проблема
JavaScript валидация блокировала сохранение поля "Пожелания на рабочем месте" при наличии латинских символов. Данные оставались только в сессии браузера, но не сохранялись в базу данных.

## Что исправлено
1. ✅ Удалена серверная CyrillicRule валидация для employer_requirements
2. ✅ Удалена JavaScript валидация кириллицы для employer_requirements
3. ✅ Добавлены команды для диагностики

## Шаги деплоя на production

### 1. Обновить код на сервере
```bash
git pull origin claude/add-english-language-support-btXGy
```

### 2. **ОБЯЗАТЕЛЬНО!** Пересобрать JavaScript
```bash
npm run build
# или
npm run production
```

**ВАЖНО:** Без этого шага изменения в JavaScript не вступят в силу!

### 3. Очистить кеш Laravel
```bash
php artisan cache:clear
php artisan view:clear
php artisan config:clear
```

### 4. Найти пользователей с пустым полем
```bash
php artisan candidate:find-empty-employer-requirements
```

Эта команда:
- Покажет список всех кандидатов с пустым полем "Пожелания на рабочем месте"
- Предложит экспортировать список в CSV
- Выведет ссылки для редактирования

### 5. Уведомить пользователей

Отправить сообщение пользователям из списка:

```
Уважаемый(ая) [Имя],

Мы обновили форму анкеты. Теперь вы можете использовать любые языки
при заполнении поля "Пожелания на рабочем месте".

Пожалуйста, зайдите в вашу анкету и заново сохраните данные:
[Ссылка на форму редактирования]

С уважением,
Команда TalentsLab
```

## Проверка работоспособности

### Тест 1: Создание новой анкеты
1. Зайти на /candidate/form
2. Заполнить поле "Пожелания на рабочем месте" текстом с латиницей
   Например: "Обучение, development opportunities, гибкий график"
3. Сохранить форму
4. Проверить отчет - данные должны отображаться

### Тест 2: Проверка существующей анкеты
1. Выбрать кандидата с ID из списка (например, 1175 или 2864)
2. Проверить командой:
   ```bash
   php artisan candidate:check 1175
   ```
3. Если employer_requirements пустое - попросить пользователя заново сохранить форму

## Возможные проблемы

### JavaScript изменения не работают
**Решение:**
```bash
# Очистить кеш браузера (Ctrl+Shift+R)
# На сервере:
npm run build
php artisan view:clear
```

### Пользователи жалуются на "Не указано"
**Решение:**
1. Проверить, пересобран ли JavaScript (`npm run build`)
2. Попросить пользователя:
   - Очистить кеш браузера (Ctrl+Shift+R)
   - Зайти в форму /candidate/form/{id}
   - Заново сохранить данные

### Данные все еще не сохраняются
**Решение:**
1. Проверить логи Laravel: `tail -f storage/logs/laravel.log`
2. Проверить консоль браузера (F12) на наличие JavaScript ошибок
3. Проверить базу данных командой: `php artisan candidate:check {id}`

## Дополнительные команды

### Проверка конкретного кандидата
```bash
php artisan candidate:check {id}
```

### Поиск всех с пустым полем
```bash
php artisan candidate:find-empty-employer-requirements
```

## Контакты для поддержки
При возникновении проблем обращайтесь к разработчику.
